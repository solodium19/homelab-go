namespace: stage
global:
  imagePullSecrets:
    - name: gitlab-regcred
  security:
    securityContext:
      runAsNonRoot: true
      runAsUser: 1001
      fsGroup: 1001
      seccompProfile:
       type: RuntimeDefault


vote: 
  name: vote-stage
  replicas: 2
  spec:
    image: registry.gitlab.com/solodium191/homelab-go/vote
    imageTag: latest
    probes:
      enabled: false
    resources:
      requests:
        cpu: "100m"
        memory: "128Mi"
      limits:
        cpu: "300m"
        memory: "256Mi"
  service:
    name: vote-service
    port: 80
    targetPort: 80
    type: ClusterIP

result:
  name: result-stage
  replicas: 2
  spec:
    image: registry.gitlab.com/solodium191/homelab-go/result
    imageTag: latest
    probes:
      enabled: false
    resources:
      requests:
        cpu: "100m"
        memory: "128Mi"
      limits:
        cpu: "300m"
        memory: "256Mi"
  service:
    name: result-service
    port: 80
    targetPort: 80
    type: ClusterIP


worker:
  name: worker-stage
  replicas: 2
  spec:
    image: registry.gitlab.com/solodium191/homelab-go/worker
    imageTag: latest
    probes:
      enabled: false
    res:
      resources:
        requests:
          cpu: "100m"
          memory: "128Mi"
        limits:
          cpu: "300m"
          memory: "256Mi"

redis: 
  enabled: false
  name: redis-stage
  probes:
    enabled: false

db:
  name: postgres-stage
  servicename: postgres-dev-svc
  replicas: 1
  storageClassName: local-path # Меняем в prod/ По хорошему даже в stage, но пока имеем что имеем и оставляем как есть \ раньше стоял local-storage, заменили на local-path( возможности размещения в облаке пока нет, но лучше всего облачное хранилище)
  storage: 3Gi
  security:
    securityContext:
      runAsGroup: 999
      runAsUser: 999
      fsGroup: 999
      seccompProfile:
        type: RuntimeDefault
  secret:
    name: postgres-secret
    user: postgres
    password: postgres
  probes:
    enabled: false

pvbd:
  enabled: false # Используем это только для девелоп окружения в нашем случае, у нас сторажкласса нет, поэтому PV придётся создать руками, если есть Storageclass просто ставим false
  name: postgres-pv
  path: /mnt/data/postgres
